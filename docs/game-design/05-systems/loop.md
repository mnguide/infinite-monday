# ë£¨í”„ ì‹œìŠ¤í…œ

## ê°œìš”

íƒ€ì„ë£¨í”„ëŠ” ê²Œì„ì˜ í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜. ê°™ì€ í•˜ë£¨ë¥¼ ë°˜ë³µí•˜ë©° ì •ë³´ë¥¼ ì¶•ì í•˜ê³  ì§„ì‹¤ì— ë‹¤ê°€ê°.

---

## ë£¨í”„ ê¸°ë³¸ ê·œì¹™

### ë£¨í”„ ì‹œì‘

```yaml
loop_start:
  time: "07:00"
  location: "home"
  scene: "home_morning"

  reset:
    - stats (health: 100, mental: 80, reputation: 50)
    - money: 25000
    - flags (ë‹¹ì¼ í”Œë˜ê·¸)
    - time

  persist:
    - totalLoops (ì¹´ìš´í„° ì¦ê°€)
    - cluesDiscovered
    - characterAffinities
    - achievedEndings
    - unlockedChoices
```

### ë£¨í”„ ì¢…ë£Œ ì¡°ê±´

| ì¡°ê±´ | ê²°ê³¼ |
|------|------|
| ì‹œê°„ 24:00 ë„ë‹¬ | ìì—° ì¢…ë£Œ â†’ ë‹¤ìŒ ë£¨í”„ |
| ì²´ë ¥ 0 | HOSPITALIZED ì—”ë”© or ê°•ì œ ì¢…ë£Œ |
| ë©˜íƒˆ 0 | BURNOUT ì—”ë”© or ê°•ì œ ì¢…ë£Œ |
| í‰íŒ 0 | FIRED ì—”ë”© or ê°•ì œ ì¢…ë£Œ |
| ì—”ë”© ì¡°ê±´ ì¶©ì¡± | í•´ë‹¹ ì—”ë”©ìœ¼ë¡œ ì´ë™ |

### ë£¨í”„ ì „í™˜ ì—°ì¶œ

```yaml
loop_transition:
  scene: "loop_transition"

  variations:
    loop_1:
      text: "...ëˆˆì„ ë–´ë‹¤."
      mood: "í‰ë²”"

    loop_2_3:
      text: "...ë˜ ì›”ìš”ì¼ì´ë‹¤."
      mood: "í˜¼ë€"

    loop_4_7:
      text: "ì•ŒëŒ ì†Œë¦¬ê°€ ìš¸ë¦°ë‹¤. ìµìˆ™í•œ ì›”ìš”ì¼."
      mood: "ì ì‘"

    loop_8_12:
      text: "ì˜¤ëŠ˜ë„ ì›”ìš”ì¼. í•˜ì§€ë§Œ ì´ë²ˆì—”..."
      mood: "ê²°ì˜"

    loop_13_plus:
      text: "ë‹¤ì‹œ ì›”ìš”ì¼. ëì´ ë³´ì¸ë‹¤."
      mood: "ë§ˆì§€ë§‰"

  next: "home_morning"
```

---

## ë£¨í”„ ì¹´ìš´í„°

### í‘œì‹œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”„ LOOP 7                          â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”                 â”‚
â”‚  ì›”ìš”ì¼ | 14:30                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë£¨í”„ ìˆ˜ì— ë”°ë¥¸ ë³€í™”

| ë£¨í”„ | í•´ê¸ˆ ìš”ì†Œ |
|------|-----------|
| 1~3 | íŠœí† ë¦¬ì–¼, ê¸°ë³¸ ì‹œìŠ¤í…œ |
| 4+ | ììœ  íƒí—˜, ìŠ¤í‚µ ì˜µì…˜ |
| 5+ | 12ì¸µ ì–¸ê¸‰, ì˜ì‹¬ ì‹œì‘ |
| 7+ | ë¯¸í–‰ ì„ íƒì§€, ë¶€ì¥ ì¶”ì  |
| 10+ | ì¤€í˜ ì§„ì‹¤, ì•¼ê°„ íƒìƒ‰ |
| 15+ | 12ì¸µ ì¹¨ì… ê°€ëŠ¥ |

---

## ì˜êµ¬ ë°ì´í„°

### ë£¨í”„ ê°„ ìœ ì§€ë˜ëŠ” ê²ƒ

```typescript
interface PermanentData {
  // ì§„í–‰ë„
  totalLoops: number;
  achievedEndings: string[];

  // ìˆ˜ì§‘
  cluesDiscovered: string[];
  unlockedChoices: string[];

  // ê´€ê³„
  characterAffinities: Record<string, number>;

  // í”Œë˜ê·¸
  permanentFlags: Record<string, boolean>;

  // ê¸ˆìœµ (ì„ íƒ)
  financialMemory?: {
    stockTips: string[];
    lotteryNumbers: number[];
  };
}
```

### ê²Œì„ì  í‘œí˜„

NPCëŠ” í”Œë ˆì´ì–´ë¥¼ ê¸°ì–µí•˜ì§€ ëª»í•˜ì§€ë§Œ...

```yaml
affinity_expression:
  high:
    dialogue: "ì™ ì§€ ëª¨ë¥´ê²Œ... ë‹¹ì‹ ì´ í¸í•˜ë„¤ìš”."
    description: |
      ì§€í˜„ì´ ì–´ìƒ‰í•˜ê²Œ ì›ƒëŠ”ë‹¤.
      ì²˜ìŒ ë§Œë‚œ ì‚¬ì´ì¸ë°, ì™œ ì´ë ‡ê²Œ ì¹œê·¼í•˜ì§€?

  low:
    dialogue: "...ë­”ê°€ ë¶ˆí¸í•´ìš”."
    description: |
      ì¤€í˜ì´ ê²½ê³„í•˜ëŠ” ëˆˆë¹›ìœ¼ë¡œ ë³¸ë‹¤.
      ë¬´ì˜ì‹ì ìœ¼ë¡œ ë­”ê°€ ëŠë¼ëŠ” ê±¸ê¹Œ.
```

---

## ë£¨í”„ í™œìš© ì „ëµ

### ì •ë³´ ì¶•ì 

```
ë£¨í”„ 1: ê¸°ë³¸ ì •ë³´ (ì¼ì •, êµ¬ì¡°)
ë£¨í”„ 2~3: ìºë¦­í„° íŒŒì•… (ì„±ê²©, ìœ„ì¹˜)
ë£¨í”„ 4~6: ë‹¨ì„œ ìˆ˜ì§‘ (íŒíŠ¸, ì†Œë¬¸)
ë£¨í”„ 7~9: ì‹¬í™” íƒìƒ‰ (ë¹„ë°€, ì—°ê²°)
ë£¨í”„ 10+: ìµœì¢… ì‹œë„ (ì¹¨ì…, ëŒ€ë©´)
```

### ê´€ê³„ ë°œì „

```yaml
relationship_strategy:
  jihyun:
    loop_1: "ì¸ì‚¬" (+3)
    loop_2: "ì ì‹¬ í•¨ê»˜" (+5)
    loop_3: "ì¹´í˜ ëŒ€í™”" (+7)
    loop_4: "ê³ ë¯¼ ë“¤ì–´ì£¼ê¸°" (+10)
    loop_5: "ì˜¥ìƒ ë…¸ì„" (+15)
    # â†’ 5ë£¨í”„ ë§Œì— í˜¸ê°ë„ 40+ ê°€ëŠ¥
```

### ì‹¤íŒ¨ í•™ìŠµ

```yaml
failure_learning:
  example: "ë¶€ì¥ ë¯¸í–‰ ì‹¤íŒ¨"

  loop_5:
    action: "ë¶€ì¥ ë¯¸í–‰ ì‹œë„"
    result: "ë°œê° â†’ í‰íŒ -20"
    learning: "17:00ì— ë¯¸í–‰í•´ì•¼ í•¨"

  loop_6:
    action: "17:00ì— ë¯¸í–‰"
    result: "ì„±ê³µ â†’ 12ì¸µ ì •ë³´"
```

---

## ìŠ¤í‚µ ì‹œìŠ¤í…œ

### ìŠ¤í‚µ ì¡°ê±´

ì´ë¯¸ ê²½í—˜í•œ ì´ë²¤íŠ¸ëŠ” ìŠ¤í‚µ ê°€ëŠ¥.

```yaml
skip_conditions:
  - "ë™ì¼ ì”¬ 3íšŒ ì´ìƒ ê²½í—˜"
  - "í•´ë‹¹ ë£¨í”„ 5+ ë„ë‹¬"
  - "ì„ íƒì§€ ê²°ê³¼ í™•ì¸ë¨"

skip_ui:
  prompt: "[ìŠ¤í‚µ] ì´ë¯¸ ì•Œê³  ìˆëŠ” ë‚´ìš©ì´ë‹¤"
  effect: "ì‹œê°„ 50% ë‹¨ì¶•, ê²°ê³¼ë§Œ ì ìš©"
```

### ìŠ¤í‚µ ë¶ˆê°€

```yaml
no_skip:
  - "ì²« ê²½í—˜ ì´ë²¤íŠ¸"
  - "í•µì‹¬ ìŠ¤í† ë¦¬ ì”¬"
  - "ì—”ë”© ê²°ì • ì”¬"
  - "ìƒˆë¡œìš´ ì„ íƒì§€ ë“±ì¥ ì”¬"
```

---

## ë£¨í”„ ì¸ì‹ ì—°ì¶œ

### í”Œë ˆì´ì–´ì˜ ì¸ì‹ ë³€í™”

```yaml
awareness_stages:
  stage_1:  # ë£¨í”„ 1
    mood: "í‰ë²”"
    dialogue: "í‰ë²”í•œ ì›”ìš”ì¼ ì•„ì¹¨ì´ë‹¤."

  stage_2:  # ë£¨í”„ 2~3
    mood: "í˜¼ë€"
    dialogue: "...ë­”ê°€ ì´ìƒí•´. ì´ê±° ì–´ì œë„..."

  stage_3:  # ë£¨í”„ 4~5
    mood: "í™•ì‹ "
    dialogue: "ì§„ì§œë¡œ ë°˜ë³µë˜ê³  ìˆì–´."

  stage_4:  # ë£¨í”„ 6~9
    mood: "ì ì‘"
    dialogue: "ì´ì œ ìµìˆ™í•´ì¡Œë‹¤. í™œìš©í•´ë³´ì."

  stage_5:  # ë£¨í”„ 10+
    mood: "íƒêµ¬"
    dialogue: "ì›ì¸ì„ ì°¾ì•„ì•¼ í•´."

  stage_6:  # ë£¨í”„ 15+
    mood: "ê²°ì˜"
    dialogue: "ì´ë²ˆì—” ëë‚¸ë‹¤."
```

### NPC ë°˜ì‘

NPCëŠ” ê¸°ì–µí•˜ì§€ ëª»í•˜ì§€ë§Œ "ì´ìƒí•œ ëŠë‚Œ" í‘œí˜„.

```yaml
npc_deja_vu:
  jihyun:
    trigger: "jihyun >= 50, loop >= 5"
    dialogue: |
      "ì´ìƒí•´... ì˜¤ë¹ ë‘ ì²˜ìŒ ì´ì•¼ê¸°í•˜ëŠ” ê²ƒ ê°™ì§€ ì•Šì•„ìš”."
      "ì™ ì§€ ìµìˆ™í•´ìš”. ì™œ ê·¸ëŸ¬ì§€?"

  junhyuk:
    trigger: "junhyuk >= 40, loop >= 7"
    dialogue: |
      "...ì„ ë°°, ì˜¤ëŠ˜ ë¬´ìŠ¨ ìš”ì¼ì´ì—ìš”?"
      "...ê·¸ë ‡ì£ , ì›”ìš”ì¼ì´ì£ ."
      (ì˜ë¯¸ì‹¬ì¥í•œ ë¯¸ì†Œ)
```

---

## íŠ¹ìˆ˜ ë£¨í”„ ì´ë²¤íŠ¸

### ë§ˆì¼ìŠ¤í†¤ ë£¨í”„

```yaml
milestone_loops:
  loop_10:
    event: "junhyuk_truth_available"
    description: "ì¤€í˜ì˜ ì§„ì‹¤ ì´ë²¤íŠ¸ í•´ê¸ˆ"

  loop_15:
    event: "lab_infiltration_available"
    description: "12ì¸µ ì¹¨ì… ê°€ëŠ¥"

  loop_25:
    event: "secret_ending_hint"
    description: "ë¹„ë°€ ì—”ë”© íŒíŠ¸ ë“±ì¥"
```

### ëœë¤ ì´ë²¤íŠ¸

ë£¨í”„ íšŸìˆ˜ì™€ ê´€ê³„ì—†ì´ í™•ë¥ ì ìœ¼ë¡œ ë°œìƒ.

```yaml
random_loop_events:
  - id: "rain_day"
    probability: 0.15
    effect: "ë¹„ ì˜¤ëŠ” ë‚  ì´ë²¤íŠ¸ ë°œë™"

  - id: "boss_good_mood"
    probability: 0.10
    effect: "ë¶€ì¥ ê¸°ë¶„ ì¢‹ìŒ"

  - id: "subway_delay"
    probability: 0.20
    effect: "ì§€í•˜ì²  ì§€ì—°"
```

---

## ë°ì´í„° êµ¬ì¡°

```typescript
interface LoopState {
  // í˜„ì¬ ë£¨í”„ ìƒíƒœ (ë¦¬ì…‹ë¨)
  currentLoop: {
    time: number;
    stats: Stats;
    flags: Record<string, boolean>;
    currentScene: string;
  };

  // ì˜êµ¬ ìƒíƒœ (ìœ ì§€ë¨)
  permanent: PermanentData;
}

interface LoopSystem {
  // ë£¨í”„ ì œì–´
  startNewLoop(): void;
  endLoop(reason: LoopEndReason): void;
  checkLoopEnd(): boolean;

  // ì˜êµ¬ ë°ì´í„°
  savePermanent(): void;
  loadPermanent(): PermanentData;

  // í•´ê¸ˆ ì²´í¬
  isUnlocked(feature: string): boolean;
  getLoopCount(): number;
}

type LoopEndReason =
  | 'time_up'
  | 'health_zero'
  | 'mental_zero'
  | 'reputation_zero'
  | 'ending';
```

---

## ë°¸ëŸ°ìŠ¤ ì›ì¹™

### ë£¨í”„ ìˆ˜ ë°¸ëŸ°ìŠ¤

- ì²« ì—”ë”© ë„ë‹¬: 7~10 ë£¨í”„
- ë©”ì¸ ì—”ë”©: 15~20 ë£¨í”„
- ë¹„ë°€ ì—”ë”©: 25+ ë£¨í”„
- 100% ë‹¬ì„±: 30~50 ë£¨í”„

### ë°˜ë³µì˜ ì¬ë¯¸

- ê°™ì€ ì¥ì†Œë„ ë‹¤ë¥¸ ì„ íƒ â†’ ë‹¤ë¥¸ ê²°ê³¼
- ì¶•ì ëœ ì •ë³´ë¡œ ìƒˆë¡œìš´ ì„ íƒì§€
- ì‹¤íŒ¨ê°€ í•™ìŠµìœ¼ë¡œ ì´ì–´ì§
- ë§¤ ë£¨í”„ ì¡°ê¸ˆì”© ì§„ì „
