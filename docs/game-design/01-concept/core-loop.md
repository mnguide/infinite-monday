# 핵심 게임 루프

## 메타 루프 (전체 게임)

```
┌─────────────────────────────────────────────────────────────┐
│                        메타 루프                              │
│  ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐   │
│  │ 루프 1  │ → │ 루프 2  │ → │ 루프 N  │ → │  엔딩   │   │
│  │ (학습)  │    │ (탐색)  │    │ (해결)  │    │ (결말)  │   │
│  └─────────┘    └─────────┘    └─────────┘    └─────────┘   │
│       ↓              ↓              ↓                        │
│   단서 획득      단서 연결      진실 규명                      │
└─────────────────────────────────────────────────────────────┘
```

### 루프 간 유지되는 것
- 발견한 단서 (Clues)
- 캐릭터 호감도 (Affinity)
- 해금된 선택지
- 엔딩 달성 기록
- 총 루프 횟수

### 루프마다 리셋되는 것
- 시간 (09:00으로)
- 스탯 (체력, 멘탈, 평판)
- 소지금
- 그날의 이벤트 플래그

---

## 일일 루프 (하루 플레이)

```
09:00          12:00          18:00          22:00
  │              │              │              │
  ▼              ▼              ▼              ▼
┌────┐        ┌────┐        ┌────┐        ┌────┐
│출근│   →   │점심│   →   │퇴근│   →   │저녁│   → 다음 루프
└────┘        └────┘        └────┘        └────┘
   │              │              │              │
   ▼              ▼              ▼              ▼
 이벤트         이벤트         이벤트         이벤트
 선택지         선택지         선택지         선택지
```

### 시간 시스템

| 시간대 | 범위 | 주요 활동 |
|--------|------|-----------|
| 아침 | 09:00~12:00 | 출근, 아침 회의, 업무 시작 |
| 점심 | 12:00~14:00 | 점심 식사, 동료와 대화 |
| 오후 | 14:00~18:00 | 업무, 회의, 조사 활동 |
| 저녁 | 18:00~22:00 | 퇴근, 야근, 개인 시간 |
| 심야 | 22:00~ | 특수 이벤트, 루프 종료 |

### 시간 소모

| 행동 유형 | 소모 시간 |
|-----------|-----------|
| 이동 | 15~30분 |
| 짧은 대화 | 15분 |
| 깊은 대화 | 30~60분 |
| 업무 | 30~120분 |
| 조사 활동 | 30~60분 |
| 식사 | 30~60분 |

---

## 선택 루프 (각 씬)

```
┌─────────────────────────────────────────┐
│              씬 진입                      │
│  ┌─────────────────────────────────┐    │
│  │  상황 묘사 (Description)          │    │
│  │  + 캐릭터 대사/행동                │    │
│  └─────────────────────────────────┘    │
│                  │                       │
│                  ▼                       │
│  ┌─────────────────────────────────┐    │
│  │  선택지 표시 (Choices)            │    │
│  │  [조건부 선택지 포함]              │    │
│  └─────────────────────────────────┘    │
│         │         │         │           │
│         ▼         ▼         ▼           │
│      선택 A    선택 B    선택 C          │
│         │         │         │           │
│         └─────────┴─────────┘           │
│                  │                       │
│                  ▼                       │
│  ┌─────────────────────────────────┐    │
│  │  결과 적용 (Effect)               │    │
│  │  - 스탯 변화                       │    │
│  │  - 시간 경과                       │    │
│  │  - 단서 획득                       │    │
│  │  - 호감도 변화                     │    │
│  │  - 플래그 설정                     │    │
│  └─────────────────────────────────┘    │
│                  │                       │
│                  ▼                       │
│            다음 씬 이동                   │
└─────────────────────────────────────────┘
```

---

## 추리 루프 (단서 시스템)

### 단서 수집

```
발견 → 획득 → 분석 → 연결 → 제시
```

1. **발견**: 특정 장소/시간에 단서 힌트 등장
2. **획득**: 올바른 선택으로 단서 확보
3. **분석**: 단서 상세 정보 확인 (단서장)
4. **연결**: 관련 단서끼리 조합
5. **제시**: 대화 중 증거로 제시

### 단서 유형

| 유형 | 설명 | 예시 |
|------|------|------|
| 물리적 증거 | 실물 증거 | 영수증, 메모, 사진 |
| 증언 | 캐릭터 발언 | "그날 부장님이..." |
| 기억 | 플레이어 경험 | 이전 루프에서 본 것 |
| 정황 | 상황 증거 | 시간대별 알리바이 |

### 증거 제시 시스템

대화 중 **[증거 제시]** 선택지 등장 시:
1. 단서장에서 관련 단서 선택
2. 올바른 증거 → 새로운 정보 해금
3. 잘못된 증거 → 페널티 (호감도 하락, 시간 소모)

---

## 엔딩 분기 루프

### 엔딩 조건 체크 타이밍

```
하루 종료 (22:00 이후)
        │
        ▼
  ┌──────────────┐
  │ 조건 체크     │
  │ - 스탯 조건   │
  │ - 플래그 조건 │
  │ - 단서 조건   │
  └──────────────┘
        │
   ┌────┴────┐
   ▼         ▼
 조건 충족   조건 미충족
   │         │
   ▼         ▼
 엔딩 씬    루프 재시작
```

### 엔딩 우선순위

1. **게임오버 엔딩** (스탯 0 도달 시 즉시)
2. **특수 엔딩** (특정 플래그 조합)
3. **일반 엔딩** (하루 종료 시 조건 충족)
4. **기본 엔딩** (조건 미충족 시 루프 지속)

---

## 세션 루프 (플레이 세션)

### 권장 세션 길이

| 세션 유형 | 시간 | 활동 |
|-----------|------|------|
| 초단기 | 3~5분 | 1개 씬 진행 |
| 단기 | 10~15분 | 1개 루프 완료 |
| 일반 | 30~45분 | 2~3개 루프 |
| 장기 | 60분+ | 엔딩 도달 시도 |

### 저장 시점

- **자동 저장**: 씬 전환 시
- **루프 저장**: 루프 시작/종료 시
- **엔딩 저장**: 엔딩 달성 시

### 세션 복귀 플로우

```
앱 재실행
    │
    ▼
┌───────────────┐
│ 저장 데이터    │
│ 불러오기       │
└───────────────┘
    │
    ▼
┌───────────────┐
│ 마지막 씬으로  │
│ 복귀           │
└───────────────┘
    │
    ▼
 "지난번 이야기..."
 (요약 표시)
```

---

## 진행도 추적

### 플레이어에게 보여주는 것

- 현재 루프 횟수
- 발견한 단서 수 / 전체
- 달성한 엔딩 수 / 전체
- 캐릭터별 호감도 레벨

### 숨기는 것

- 전체 엔딩 조건
- 미발견 단서의 존재
- 히든 선택지의 존재
- 진짜 탈출 조건

---

## 밸런스 원칙

### 시간 밸런스

- 하루 = 약 780분 (09:00~22:00)
- 필수 업무 = 약 300분
- 자유 시간 = 약 480분
- 모든 장소 방문 불가 → 선택 필요

### 난이도 곡선

| 루프 | 난이도 | 특징 |
|------|--------|------|
| 1~3 | 튜토리얼 | 기본 시스템 학습 |
| 4~7 | 탐색기 | 자유 탐험, 단서 수집 |
| 8~12 | 도전기 | 퍼즐 해결, 관계 심화 |
| 13+ | 마스터리 | 최적화, 히든 엔딩 도전 |

### 실패의 가치

- 모든 실패는 정보를 줌
- "잘못된" 선택도 단서가 됨
- 게임오버 엔딩도 달성률에 포함
- 반복 플레이 = 의도된 디자인
